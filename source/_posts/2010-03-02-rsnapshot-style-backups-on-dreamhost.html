---
layout: post
title: 'RSnapshot-style backups on Dreamhost'
date: 2010-03-02
comments: true
permalink: /2010/03/rsnapshot-style-backups-on-dreamhost.html
---

<div class='post'>
<h1>DHSnapshot</h1>A while ago I needed to find a good setup for backing up some machines.<br /><br />I wanted to use <a href="http://samba.anu.edu.au/rsync/">RSync</a> to do <a href="http://www.mikerubel.org/computers/rsync_snapshots/">snapshots-like backups</a>.<br /><br />This setup is:<br />* Off-site<br />* Storage efficient (the bulk of my backup was unlikely to ever change)<br />* Network efficient (only transfer changed files)<br />* Keeps versions going back a few months<br /><br />Now, <a href="http://www.dreamhost.com">DreamHost</a> offers 50GB of free space for personal backups and that seemed a good fit for this particular situation.<br /><br />Then I found <a href="http://rsnapshot.org/">RSnapshot</a> and it was exactly what I needed.<br />Unfortunately, RSnapshot doesn't backup to an external server. <br />It's meant to work in a setup where the server hosting the backups connects to your data sources and pull the files.<br />That totally makes sense and is probably the best setup but it wouldn't work for me.<br /><br />DreamHost doesn't have RSnapshot installed on their backup servers and the only access users have to that machine is SFTP and RSync. <br />I needed something that would work with just that.<br /><br />I came across a post about <a href="http://blog.wangling.me/2009/07/meta-backup-dreamhost-on-dreamhost-backups/">backing up DreamHost websites to DreamHost Backups</a> that showed a workaround to the lack of SSH access to the backups service.<br /><br />So I took the idea, mixed it up with the stuff I wanted from RSnapshot and wrote a small perl script to do it.<br /><br />It's called <a href="http://github.com/carloslima/dhsnapshot">dhsnapshot</a> and is published at GitHub: <a href="http://github.com/carloslima/dhsnapshot">http://github.com/carloslima/dhsnapshot</a> <br /><br />At this moment, it's not very flexible: it's hardwired to keep 7 daily, 4 weekly and 6 monthly backups and it's also limited to a single backup source (you can only point it to one source directory)<br />But it's not hard to change, or even make it configurable.<br />I might do it if I ever get the need or motivation :)<br /><br />One way or the other, it should be reasonably simple to setup (<a href="http://github.com/carloslima/dhsnapshot#readme">instructions on GitHub</a>).<br /><br />I'd be glad to know if it helped anyone.<br />So, please, drop me a comment if you fnd it useful.</div>
